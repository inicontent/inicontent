import{d8 as f,d1 as v,H as b,d9 as m,d2 as i}from"./entry.965cbfb6.js";import{u as o}from"./fetch.eef88911.js";import{b as c}from"./index.d4f86f82.js";const w=f(async(a,g)=>{var p;let e,l;const u=v("User"),r=b("User"),n=b("database");if(u.value&&u.value.username&&u.value.password){if(r.value=([e,l]=m(()=>{var s;return o(`https://api.inicontent.com/${(s=a.params.db_slug)!=null?s:"inicontent"}/auth/current`,{headers:{Authorization:"Basic "+c.Buffer.from(`${u.value.username}:${u.value.password}`).toString("base64")},transform:t=>t.result,key:u.value.username},"$IBYrTh3xUa")}),e=await e,l(),e).data.value,r.value&&r.value.id){if(r.value.password=u.value.password,["auth","db_slug-auth"].includes(a.name))return i(a.params.db_slug?`/${a.params.db_slug}`:"/dashboard")}else if(!["auth","db_slug-auth"].includes(a.name))return u.value=null,r.value=null,i(a.params.db_slug?`/${a.params.db_slug}/auth`:"/auth");if((!n.value||n.value.slug!==a.params.db_slug)&&(n.value=([e,l]=m(()=>{var s,t;return o(`https://api.inicontent.com/inicontent/db/${(s=a.params.db_slug)!=null?s:"inicontent"}`,{headers:{Authorization:"Basic "+c.Buffer.from(`${r.value.username}:${r.value.password}`).toString("base64")},transform:d=>d.result,key:((t=a.params.db_slug)!=null?t:"inicontent")+r.value.username},"$jQcfUYmJtu")}),e=await e,l(),e).data.value),a.params.table_slug&&(!n.value.tables||!n.value.tables.find(s=>s.slug===a.params.table_slug)))return i(`/${a.params.db_slug}`)}else if(["auth","db_slug-auth"].includes(a.name))n.value=([e,l]=m(()=>{var s,t;return o(`https://api.inicontent.com/inicontent/db/${(s=a.params.db_slug)!=null?s:"inicontent"}`,{transform:d=>d.result,key:(t=a.params.db_slug)!=null?t:"inicontent"},"$7hZpyFmHoT")}),e=await e,l(),e).data.value;else return i(`/${(p=a.params.db_slug)!=null?p:""}/auth`)});export{w as default};
